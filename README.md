# 摸鱼人日历插件

一个功能完善的 AstrBot 摸鱼人日历插件，支持精确定时发送、多群组不同时间设置、自定义触发词，并提供多种精美排版样式。

## 功能特点

- 🎯 精确定时发送，无需轮询检测
- 🌟 支持多群组不同时间设置
- 🔧 支持自定义触发词（默认为"摸鱼"）
- 🎨 提供多种精美排版样式，每次随机选择
- ⚡ 支持立即发送功能
- 🔄 自动备份异常配置文件
- 🌐 多API源支持，自动故障转移
- 🕒 显示下一次发送的等待时间

## 使用说明

### 命令列表

- `/set_time HH:MM` - 设置发送时间，格式为24小时制
  - 例如：`/set_time 09:30` 或 `/set_time 0930`
  - 设置成功后会显示下一次发送的等待时间
- `/reset_time` - 取消当前群聊的定时设置（触发词仍可使用）
- `/list_time` - 查看当前群聊的时间设置与触发词
- `/execute_now` - 立即发送摸鱼人日历
- `/set_trigger 触发词` - 设置触发词，默认为"摸鱼"

### 触发方式

1. 定时发送：在设定的时间自动发送
2. 触发词发送：检测到触发词时发送
3. 手动发送：使用 `/execute_now` 命令立即发送

## 常见问题

Q: 为什么我设置了定时但到时间没有反应？  
A: 可能的原因：
1. （Docker部署）容器时间与主机时间不同步，请确保已正确映射时区
2. 配置文件权限问题，请确保插件有读写权限
3. 如果以上都不是，请查看日志并提交 issue

Q: 为什么显示获取图片失败？  
A: 插件使用了多个备用API源，如果都获取失败，可能是：
1. 网络连接问题
2. API服务暂时不可用
3. 如果持续失败，请提交 issue 或联系作者更换API源

Q: 为什么默认的触发词发送检测不到？  
A: 请检查该群聊是否设置过时间或者触发词，如果没有设置过此群聊的消息并不在监听返回。设置后即可恢复正常

## 更新日志

### v2.1.0
- 优化消息发送机制，解决跨平台兼容性问题
- 改进 `/reset_time` 命令，现在会从任务队列中删除对应任务
- 添加等待时间显示，设置时间后会显示下一次发送的等待时间
- 优化错误处理和日志记录
- 改进消息格式，添加表情符号使消息更友好
- 修复了多个稳定性问题

### v2.0.0
- 重构代码结构，提高可维护性
- 添加多API源支持，提高可用性
- 优化错误处理机制
- 添加配置文件自动备份功能
- 新增多种排版样式
- 改进定时器实现，提高精确度

## 支持与反馈

- 提交 Issue：[GitHub Issues](https://github.com/quirrel-zh/astrbot_plugin_moyuren/issues)
- 联系作者：可在群聊中搜索 quirrel-zh
- 帮助文档：[AstrBot 官方文档](https://astrbot.app/dev/plugin.html)
